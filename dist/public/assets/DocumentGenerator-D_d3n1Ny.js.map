{"version":3,"file":"DocumentGenerator-D_d3n1Ny.js","sources":["../../../client/src/pages/DocumentGenerator.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Bot,\n  CheckCircle2,\n  Copy,\n  Download,\n  FileText,\n  Loader2,\n  RefreshCw,\n  Save,\n  Sparkles,\n} from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { useAuth } from \"@/_core/hooks/useAuth\";\nimport { trpc } from \"@/lib/trpc\";\nimport type { inferRouterOutputs } from \"@trpc/server\";\nimport type { AppRouter } from \"../../../server/routers\";\n\ntype RouterOutputs = inferRouterOutputs<AppRouter>;\ntype TemplateApiModel = RouterOutputs[\"documentGenerator\"][\"getTemplates\"][\"templates\"][number];\n\ntype TemplateField = {\n  key: string;\n  label: string;\n  placeholder?: string;\n  required?: boolean;\n  type?: string;\n};\n\ntype TemplateOption = {\n  code: string;\n  title: string;\n  category?: string;\n  description?: string;\n  body?: string;\n  placeholders: TemplateField[];\n};\n\nconst FALLBACK_TEMPLATES: TemplateOption[] = [\n  {\n    code: \"salary-letter\",\n    title: \"خطاب تعريف بالراتب\",\n    category: \"تعريف\",\n    body: `إلى من يهمه الأمر،\n\nنفيدكم بأن الموظف {{employee_name}} يعمل لدينا في {{company_name}} بوظيفة {{job_title}} منذ {{start_date}} ويتقاضى راتباً شهرياً قدره {{salary}} ريال.\n\nتحريراً في {{issue_date}}،\n{{company_name}}`,\n    placeholders: [\n      { key: \"employee_name\", label: \"اسم الموظف\" },\n      { key: \"company_name\", label: \"اسم الشركة\" },\n      { key: \"job_title\", label: \"المسمى الوظيفي\" },\n      { key: \"start_date\", label: \"تاريخ البداية\" },\n      { key: \"salary\", label: \"الراتب\" },\n      { key: \"issue_date\", label: \"تاريخ الإصدار\" },\n    ],\n  },\n  {\n    code: \"offer-letter\",\n    title: \"عرض وظيفي\",\n    category: \"توظيف\",\n    body: `يسر {{company_name}} أن يقدم لكم عرض عمل لوظيفة {{job_title}} في قسم {{department}} براتب شهري {{salary}} ريال.\n\nتاريخ المباشرة المتوقع: {{start_date}}\nيرجى تأكيد قبول العرض خلال 5 أيام عمل.\n\nمع خالص التحية،\nفريق الموارد البشرية`,\n    placeholders: [\n      { key: \"company_name\", label: \"اسم الشركة\" },\n      { key: \"job_title\", label: \"المسمى الوظيفي\" },\n      { key: \"department\", label: \"القسم\" },\n      { key: \"salary\", label: \"الراتب\" },\n      { key: \"start_date\", label: \"تاريخ المباشرة\" },\n    ],\n  },\n  {\n    code: \"experience-letter\",\n    title: \"شهادة خبرة\",\n    category: \"خبرة\",\n    body: `نشهد بأن السيد/السيدة {{employee_name}} عمل معنا في {{company_name}} بوظيفة {{job_title}} في الفترة من {{start_date}} حتى {{end_date}}.\n\nخلال تلك المدة أظهر التزاماً ومهنية عالية.\nتمنياتنا له بالتوفيق.\n\n{{company_name}}`,\n    placeholders: [\n      { key: \"employee_name\", label: \"اسم الموظف\" },\n      { key: \"company_name\", label: \"اسم الشركة\" },\n      { key: \"job_title\", label: \"المسمى الوظيفي\" },\n      { key: \"start_date\", label: \"تاريخ البداية\" },\n      { key: \"end_date\", label: \"تاريخ النهاية\" },\n    ],\n  },\n];\n\nconst DEFAULT_FIELDS: TemplateField[] = [\n  { key: \"employeeName\", label: \"اسم الموظف\" },\n  { key: \"employeeId\", label: \"الرقم الوظيفي\" },\n  { key: \"companyName\", label: \"اسم الشركة\" },\n  { key: \"jobTitle\", label: \"المسمى الوظيفي\" },\n  { key: \"department\", label: \"القسم\" },\n  { key: \"startDate\", label: \"تاريخ البداية\" },\n  { key: \"endDate\", label: \"تاريخ النهاية\" },\n  { key: \"salary\", label: \"الراتب\" },\n  { key: \"issueDate\", label: \"تاريخ الإصدار\" },\n];\n\nconst parsePlaceholderSchema = (schema?: string | null): TemplateField[] => {\n  if (!schema) return [];\n  try {\n    const parsed = typeof schema === \"string\" ? JSON.parse(schema) : schema;\n    if (Array.isArray(parsed)) {\n      return parsed\n        .map((item: Record<string, unknown>) => ({\n          key: typeof item?.key === \"string\" ? item.key : \"\",\n          label:\n            typeof item?.label === \"string\"\n              ? item.label\n              : typeof item?.key === \"string\"\n              ? item.key\n              : \"حقل\",\n          placeholder: typeof item?.placeholder === \"string\" ? item.placeholder : undefined,\n          required: typeof item?.required === \"boolean\" ? item.required : undefined,\n          type: typeof item?.type === \"string\" ? item.type : undefined,\n        }))\n        .filter(field => field.key);\n    }\n    if (parsed && Array.isArray(parsed.fields)) {\n      return (parsed.fields as Record<string, unknown>[])\n        .map(field => ({\n          key: typeof field?.key === \"string\" ? field.key : \"\",\n          label:\n            typeof field?.label === \"string\"\n              ? field.label\n              : typeof field?.key === \"string\"\n              ? field.key\n              : \"حقل\",\n          placeholder:\n            typeof field?.placeholder === \"string\" ? field.placeholder : undefined,\n          required: typeof field?.required === \"boolean\" ? field.required : undefined,\n          type: typeof field?.type === \"string\" ? field.type : undefined,\n        }))\n        .filter(field => field.key);\n    }\n  } catch (error) {\n    console.warn(\"Invalid placeholders schema\", error);\n  }\n  return [];\n};\n\nconst normalizeTemplateRecord = (template: TemplateApiModel): TemplateOption => ({\n  code: template.code,\n  title:\n    template.titleAr ||\n    template.nameAr ||\n    template.titleEn ||\n    template.nameEn ||\n    template.code,\n  category: template.nameAr,\n  description: template.description || undefined,\n  body: template.content || undefined,\n  placeholders:\n    parsePlaceholderSchema(template.placeholdersSchema).length > 0\n      ? parsePlaceholderSchema(template.placeholdersSchema)\n      : DEFAULT_FIELDS,\n});\n\nconst toSnakeCase = (value: string) =>\n  value\n    .replace(/([a-z0-9])([A-Z])/g, \"$1_$2\")\n    .replace(/[-\\s]+/g, \"_\")\n    .toLowerCase();\n\nconst applyVariablesToBody = (body: string, variables: Record<string, string>) => {\n  return Object.entries(variables).reduce((acc, [key, rawValue]) => {\n    const value = rawValue || `{{${key}}}`;\n    const variants = Array.from(\n      new Set([\n        key,\n        key.toLowerCase(),\n        toSnakeCase(key),\n        key.replace(/_/g, \"\"),\n        toSnakeCase(key).replace(/_/g, \"\"),\n      ])\n    );\n    return variants.reduce((result, token) => {\n      const regex = new RegExp(`{{\\s*${token}\\s*}}`, \"gi\");\n      return result.replace(regex, value);\n    }, acc);\n  }, body);\n};\n\nconst toneToStyleMap: Record<\"رسمي\" | \"شبه رسمي\" | \"ودي\", \"formal\" | \"semi-formal\" | \"friendly\"> = {\n  رسمي: \"formal\",\n  \"شبه رسمي\": \"semi-formal\",\n  ودي: \"friendly\",\n};\n\nconst languageLabelMap: Record<\"ar\" | \"en\" | \"both\", string> = {\n  ar: \"العربية\",\n  en: \"English\",\n  both: \"ثنائي\",\n};\n\nconst isDocumentLanguage = (value: string): value is \"ar\" | \"en\" | \"both\" =>\n  value === \"ar\" || value === \"en\" || value === \"both\";\n\nconst isToneOption = (value: string): value is \"رسمي\" | \"شبه رسمي\" | \"ودي\" =>\n  value === \"رسمي\" || value === \"شبه رسمي\" || value === \"ودي\";\n\nexport default function DocumentGenerator() {\n  const { user } = useAuth();\n  const [selectedTemplate, setSelectedTemplate] = useState<string>(FALLBACK_TEMPLATES[0]?.code || \"\");\n  const [language, setLanguage] = useState<\"ar\" | \"en\" | \"both\">(\"ar\");\n  const [tone, setTone] = useState<\"رسمي\" | \"شبه رسمي\" | \"ودي\">(\"رسمي\");\n  const [includeStamp, setIncludeStamp] = useState(true);\n  const [variables, setVariables] = useState<Record<string, string>>({});\n  const [notes, setNotes] = useState(\"\");\n  const [aiSuggestion, setAiSuggestion] = useState<string | null>(null);\n  const [previewHtml, setPreviewHtml] = useState(\"\");\n  const [previewText, setPreviewText] = useState(\"\");\n  const [lastDocumentId, setLastDocumentId] = useState<number | null>(null);\n  const [isLastDocumentSaved, setIsLastDocumentSaved] = useState(false);\n\n  const templatesQuery = trpc.documentGenerator.getTemplates.useQuery(undefined, {\n    staleTime: 1000 * 60 * 5,\n  });\n\n  useEffect(() => {\n    if (templatesQuery.error) {\n      toast.error(\"تعذر تحميل القوالب، سيتم استخدام القوالب الافتراضية\");\n    }\n  }, [templatesQuery.error]);\n\n  const templates = useMemo(() => {\n    if (templatesQuery.data?.templates?.length) {\n      return templatesQuery.data.templates.map(normalizeTemplateRecord);\n    }\n    return FALLBACK_TEMPLATES;\n  }, [templatesQuery.data]);\n\n  useEffect(() => {\n    if (!templates.length) return;\n    setSelectedTemplate(prev => {\n      if (prev && templates.some(t => t.code === prev)) {\n        return prev;\n      }\n      return templates[0].code;\n    });\n  }, [templates]);\n\n  const template = useMemo(\n    () => templates.find(t => t.code === selectedTemplate) || templates[0],\n    [selectedTemplate, templates]\n  );\n\n  const templateFields = useMemo(() => {\n    if (template?.placeholders?.length) {\n      return template.placeholders;\n    }\n    return DEFAULT_FIELDS;\n  }, [template]);\n\n  useEffect(() => {\n    if (!templateFields.length) return;\n    setVariables(prev => {\n      const updated: Record<string, string> = {};\n      templateFields.forEach(field => {\n        updated[field.key] = prev[field.key] || \"\";\n      });\n      return updated;\n    });\n  }, [templateFields]);\n\n  useEffect(() => {\n    setPreviewHtml(\"\");\n    setPreviewText(\"\");\n    setLastDocumentId(null);\n    setIsLastDocumentSaved(false);\n  }, [selectedTemplate]);\n\n  const fallbackBody = useMemo(() => {\n    if (template?.body) {\n      return applyVariablesToBody(template.body, variables);\n    }\n    const filledVariables = Object.entries(variables)\n      .filter(([, value]) => Boolean(value))\n      .map(([key, value]) => `${key}: ${value}`)\n      .join(\"\\n\");\n    if (filledVariables) {\n      return filledVariables;\n    }\n    return \"سيتم توليد المستند فور تعبئة الحقول والضغط على توليد\";\n  }, [template, variables]);\n\n  const documentMutation = trpc.documentGenerator.generateDocument.useMutation({\n    onSuccess: data => {\n      setPreviewHtml(data.outputHtml || \"\");\n      setPreviewText(data.outputText || \"\");\n      setLastDocumentId(data.documentId ?? null);\n      setIsLastDocumentSaved(false);\n      toast.success(\"تم توليد المستند وحفظه في السجل\");\n    },\n    onError: error => {\n      toast.error(error.message || \"فشل في توليد المستند، حاول مرة أخرى\");\n    },\n  });\n\n  const toggleSaveMutation = trpc.documentGenerator.toggleSaveDocument.useMutation({\n    onSuccess: data => {\n      setIsLastDocumentSaved(data.isSaved);\n      toast.success(data.isSaved ? \"تم حفظ المستند في مكتبتي\" : \"تمت إزالة المستند من المفضلة\");\n    },\n    onError: error => {\n      toast.error(error.message || \"تعذر تحديث حالة الحفظ\");\n    },\n  });\n\n  const handleGenerate = async () => {\n    if (!user) {\n      toast.error(\"الرجاء تسجيل الدخول للاستفادة من مولد المستندات\");\n      return;\n    }\n    if (!template) {\n      toast.error(\"لم يتم العثور على القالب\");\n      return;\n    }\n    const missingRequired = templateFields.filter(\n      field => field.required && !variables[field.key]?.trim()\n    );\n    if (missingRequired.length) {\n      toast.error(`يرجى تعبئة الحقول: ${missingRequired.map(f => f.label).join(\"، \")}`);\n      return;\n    }\n\n    const inputData = {\n      ...variables,\n      notes,\n      includeStamp,\n      tone,\n      language,\n    };\n\n    const companyName =\n      variables.companyName ||\n      variables.company_name ||\n      variables[\"company\"] ||\n      undefined;\n\n    await documentMutation.mutateAsync({\n      templateCode: template.code,\n      inputData,\n      lang: language,\n      style: toneToStyleMap[tone],\n      companyName,\n      companyLogo: includeStamp ? \"auto-stamp\" : undefined,\n    });\n  };\n\n  const handleCopy = async () => {\n    const contentToCopy = previewText || fallbackBody;\n    if (!contentToCopy) {\n      toast.info(\"لا يوجد نص لنسخه بعد\");\n      return;\n    }\n    await navigator.clipboard.writeText(contentToCopy);\n    toast.success(\"تم نسخ المستند للحافظة\");\n  };\n\n  const handleDownload = () => {\n    const content = previewHtml || previewText || fallbackBody;\n    if (!content) {\n      toast.info(\"قم بتوليد المستند قبل التحميل\");\n      return;\n    }\n    const isHtml = Boolean(previewHtml);\n    const blob = new Blob([previewHtml || content], {\n      type: isHtml ? \"text/html;charset=utf-8\" : \"text/plain;charset=utf-8\",\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.href = url;\n    const safeTitle = (template?.title || \"document\").replace(/[^a-zA-Z0-9\\u0600-\\u06FF]+/g, \"-\");\n    link.download = `${safeTitle || \"document\"}.${isHtml ? \"html\" : \"txt\"}`;\n    link.click();\n    URL.revokeObjectURL(url);\n    toast.success(\"تم تجهيز المستند للتحميل\");\n  };\n\n  const handleSaveDocument = () => {\n    if (!user) {\n      toast.error(\"الرجاء تسجيل الدخول لحفظ المستندات\");\n      return;\n    }\n    if (!lastDocumentId) {\n      toast.info(\"قم بتوليد المستند أولاً\");\n      return;\n    }\n    toggleSaveMutation.mutate({ documentId: lastDocumentId });\n  };\n\n  const askAI = () => {\n    setAiSuggestion(\n      `اقتراح: أضف فقرة توضح الغرض من المستند \"${template?.title || \"المستند\"}\" وتأكيد صحة البيانات.`\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      <div className=\"container mx-auto px-4 py-10 space-y-6\">\n        <div className=\"flex flex-col gap-3\">\n          <Badge className=\"w-fit\">مولد المستندات الذكي</Badge>\n          <h1 className=\"text-3xl font-bold text-slate-900\">أنشئ مستندات جاهزة بثوانٍ</h1>\n          <p className=\"text-muted-foreground max-w-2xl\">\n            اختر قالباً، املأ المتغيرات الأساسية، واحصل على مستند منسق مع خيار ختم إلكتروني\n            وإدراج الشعار لاحقاً.\n          </p>\n        </div>\n\n        <div className=\"grid gap-4 lg:grid-cols-[1.2fr_1fr]\">\n          {/* Form */}\n          <Card className=\"shadow-sm\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-5 w-5 text-purple-600\" />\n                بيانات المستند\n              </CardTitle>\n              <CardDescription>املأ المعلومات الأساسية وسيتم توليد المستند فوراً</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between gap-2\">\n                    <Label>القالب</Label>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"text-xs\"\n                      onClick={() => templatesQuery.refetch()}\n                      disabled={templatesQuery.isFetching}\n                    >\n                      {templatesQuery.isFetching ? (\n                        <Loader2 className=\"h-3.5 w-3.5 animate-spin\" />\n                      ) : (\n                        <RefreshCw className=\"h-3.5 w-3.5\" />\n                      )}\n                    </Button>\n                  </div>\n                  <Select value={selectedTemplate} onValueChange={setSelectedTemplate}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {templates.map(t => (\n                        <SelectItem key={t.code} value={t.code}>\n                          {t.title}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>اللغة</Label>\n                  <Select\n                    value={language}\n                    onValueChange={val => {\n                      if (isDocumentLanguage(val)) {\n                        setLanguage(val);\n                      }\n                    }}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"ar\">العربية</SelectItem>\n                      <SelectItem value=\"en\">English</SelectItem>\n                      <SelectItem value=\"both\">ثنائي</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                <div className=\"space-y-2\">\n                  <Label>نبرة المستند</Label>\n                  <Select\n                    value={tone}\n                    onValueChange={val => {\n                      if (isToneOption(val)) {\n                        setTone(val);\n                      }\n                    }}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"رسمي\">رسمي</SelectItem>\n                      <SelectItem value=\"شبه رسمي\">شبه رسمي</SelectItem>\n                      <SelectItem value=\"ودي\">ودي</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>الختم والشعار</Label>\n                  <Button\n                    variant={includeStamp ? \"default\" : \"outline\"}\n                    onClick={() => setIncludeStamp(prev => !prev)}\n                    className=\"w-full\"\n                  >\n                    {includeStamp ? \"تضمين الختم\" : \"بدون ختم\"}\n                  </Button>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>ملاحظات إضافية</Label>\n                  <Input\n                    placeholder=\"مثال: نسخة للبنك\"\n                    value={notes}\n                    onChange={e => setNotes(e.target.value)}\n                  />\n                </div>\n              </div>\n\n              <Separator />\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {templateFields.map(field => (\n                  <div key={field.key} className=\"space-y-2\">\n                    <Label className=\"flex items-center justify-between\">\n                      <span>{field.label}</span>\n                      {field.required && <span className=\"text-xs text-red-500\">مطلوب</span>}\n                    </Label>\n                    {field.type === \"textarea\" ? (\n                      <Textarea\n                        rows={3}\n                        placeholder={field.placeholder}\n                        value={variables[field.key] || \"\"}\n                        onChange={e =>\n                          setVariables(prev => ({ ...prev, [field.key]: e.target.value }))\n                        }\n                      />\n                    ) : (\n                      <Input\n                        placeholder={field.placeholder}\n                        value={variables[field.key] || \"\"}\n                        onChange={e =>\n                          setVariables(prev => ({ ...prev, [field.key]: e.target.value }))\n                        }\n                      />\n                    )}\n                  </div>\n                ))}\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <Button\n                  onClick={handleGenerate}\n                  className=\"bg-gradient-to-r from-purple-600 to-blue-600\"\n                  disabled={documentMutation.isPending}\n                >\n                  {documentMutation.isPending ? (\n                    <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                  ) : (\n                    <Sparkles className=\"h-4 w-4 ml-2\" />\n                  )}\n                  {documentMutation.isPending ? \"جاري التوليد\" : \"توليد المستند\"}\n                </Button>\n                <Button variant=\"outline\" onClick={askAI}>\n                  <Bot className=\"h-4 w-4 ml-2\" />\n                  اقتراح من الذكاء الاصطناعي\n                </Button>\n              </div>\n\n              {aiSuggestion && (\n                <div className=\"p-3 rounded-lg bg-blue-50 text-sm text-blue-900\">\n                  {aiSuggestion}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Preview */}\n          <Card className=\"shadow-sm\">\n            <CardHeader>\n              <CardTitle>معاينة المستند</CardTitle>\n              <CardDescription>يمكنك النسخ أو التحميل أو الحفظ في مكتبتي</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex flex-wrap gap-2\">\n                <Badge variant=\"outline\">{template?.title}</Badge>\n                <Badge variant=\"secondary\">{tone}</Badge>\n                <Badge variant=\"outline\">{languageLabelMap[language]}</Badge>\n                {includeStamp && <Badge className=\"bg-emerald-100 text-emerald-700\">ختم إلكتروني</Badge>}\n                {templatesQuery.isFetching && (\n                  <Badge variant=\"outline\" className=\"flex items-center gap-1\">\n                    <Loader2 className=\"h-3.5 w-3.5 animate-spin\" /> تحديث القوالب\n                  </Badge>\n                )}\n              </div>\n              <div className=\"rounded-xl border bg-white p-4 min-h-[260px] space-y-3\">\n                {previewHtml ? (\n                  <div\n                    className=\"prose prose-sm max-w-none rtl text-right\"\n                    dangerouslySetInnerHTML={{ __html: previewHtml }}\n                  />\n                ) : (\n                  <pre className=\"whitespace-pre-wrap text-sm leading-6\">{previewText || fallbackBody}</pre>\n                )}\n              </div>\n              <div className=\"flex flex-wrap gap-2\">\n                <Button variant=\"outline\" onClick={handleCopy}>\n                  <Copy className=\"h-4 w-4 ml-2\" />\n                  نسخ\n                </Button>\n                <Button variant=\"outline\" onClick={handleDownload}>\n                  <Download className=\"h-4 w-4 ml-2\" />\n                  تحميل PDF/Word\n                </Button>\n                <Button\n                  variant={isLastDocumentSaved ? \"default\" : \"outline\"}\n                  onClick={handleSaveDocument}\n                  disabled={toggleSaveMutation.isPending}\n                >\n                  {toggleSaveMutation.isPending ? (\n                    <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                  ) : (\n                    <Save className=\"h-4 w-4 ml-2\" />\n                  )}\n                  {isLastDocumentSaved ? \"تم الحفظ\" : \"حفظ في مكتبتي\"}\n                </Button>\n                <Button variant=\"ghost\">\n                  <CheckCircle2 className=\"h-4 w-4 ml-2\" />\n                  إرسال للمراجعة\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["FALLBACK_TEMPLATES","DEFAULT_FIELDS","parsePlaceholderSchema","schema","parsed","item","field","error","normalizeTemplateRecord","template","toSnakeCase","value","applyVariablesToBody","body","variables","acc","key","rawValue","result","token","regex","toneToStyleMap","languageLabelMap","isDocumentLanguage","isToneOption","DocumentGenerator","user","useAuth","selectedTemplate","setSelectedTemplate","useState","language","setLanguage","tone","setTone","includeStamp","setIncludeStamp","setVariables","notes","setNotes","aiSuggestion","setAiSuggestion","previewHtml","setPreviewHtml","previewText","setPreviewText","lastDocumentId","setLastDocumentId","isLastDocumentSaved","setIsLastDocumentSaved","templatesQuery","trpc","useEffect","toast","templates","useMemo","prev","t","templateFields","updated","fallbackBody","filledVariables","documentMutation","data","toggleSaveMutation","handleGenerate","missingRequired","f","inputData","companyName","handleCopy","contentToCopy","handleDownload","content","isHtml","blob","url","link","safeTitle","handleSaveDocument","askAI","jsxs","jsx","Badge","Card","CardHeader","CardTitle","FileText","CardDescription","CardContent","Label","Button","Loader2","RefreshCw","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","val","Input","e","Separator","Textarea","Sparkles","Bot","Copy","Download","Save","CheckCircle2"],"mappings":"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"}