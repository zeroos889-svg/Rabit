{"version":3,"file":"SecurityIncidents-DFt_ehk6.js","sources":["../../../client/src/pages/admin/SecurityIncidents.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useAuth } from \"@/_core/hooks/useAuth\";\nimport { trpc } from \"@/lib/trpc\";\nimport { toast } from \"sonner\";\nimport {\n  AlertTriangle,\n  Shield,\n  Clock,\n  CheckCircle,\n  AlertCircle,\n  Plus,\n  Send,\n  Users,\n} from \"lucide-react\";\nimport { useLocation } from \"wouter\";\n\n/**\n * ÿµŸÅÿ≠ÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≠ŸàÿßÿØÿ´ ÿßŸÑÿ£ŸÖŸÜŸäÿ© (ŸÑŸÑÿ£ÿØŸÖŸÜ)\n * PDPL Requirement: ÿßŸÑÿ•ÿÆÿ∑ÿßÿ± ÿπŸÜ ÿßŸÑÿÆÿ±ŸàŸÇÿßÿ™ ÿÆŸÑÿßŸÑ 72 ÿ≥ÿßÿπÿ©\n */\nexport default function AdminSecurityIncidents() {\n  const { user, loading } = useAuth();\n  const [, setLocation] = useLocation();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n\n  // Form state\n  const [description, setDescription] = useState(\"\");\n  const [cause, setCause] = useState(\"\");\n  const [affectedDataCategories, setAffectedDataCategories] = useState(\"\");\n  const [affectedUsersCount, setAffectedUsersCount] = useState(\"\");\n  const [riskLevel, setRiskLevel] = useState<\"low\" | \"medium\" | \"high\">(\n    \"medium\"\n  );\n\n  // Queries\n  const { data, isLoading, refetch } = trpc.adminPdpl.getIncidents.useQuery();\n\n  // Mutations\n  const createIncidentMutation = trpc.adminPdpl.createIncident.useMutation({\n    onSuccess: () => {\n      toast.success(\"ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿßÿØÿ´ ÿ®ŸÜÿ¨ÿßÿ≠\");\n      setIsDialogOpen(false);\n      resetForm();\n      refetch();\n    },\n  });\n\n  const updateIncidentMutation = trpc.adminPdpl.updateIncident.useMutation({\n    onSuccess: () => {\n      toast.success(\"ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≠ÿßÿØÿ´ ÿ®ŸÜÿ¨ÿßÿ≠\");\n      refetch();\n    },\n  });\n\n  const resetForm = () => {\n    setDescription(\"\");\n    setCause(\"\");\n    setAffectedDataCategories(\"\");\n    setAffectedUsersCount(\"\");\n    setRiskLevel(\"medium\");\n  };\n\n  const handleCreateIncident = () => {\n    if (!description) {\n      toast.error(\"Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ŸàÿµŸÅ ÿßŸÑÿ≠ÿßÿØÿ´\");\n      return;\n    }\n\n    createIncidentMutation.mutate({\n      description,\n      cause: cause || undefined,\n      affectedDataCategories: affectedDataCategories || undefined,\n      affectedUsersCount: affectedUsersCount\n        ? parseInt(affectedUsersCount)\n        : undefined,\n      riskLevel,\n    });\n  };\n\n  const handleReportToSdaia = (incidentId: number) => {\n    if (confirm(\"ŸáŸÑ ÿ™ŸÖ ÿ•ÿ®ŸÑÿßÿ∫ ÿ≥ÿØÿßŸäÿß ŸÅÿπŸÑŸäÿßŸã ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ≠ÿßÿØÿ´ÿü\")) {\n      updateIncidentMutation.mutate({\n        incidentId,\n        reportedToSdaiaAt: new Date(),\n        status: \"reported\",\n      });\n    }\n  };\n\n  const handleReportToUsers = (incidentId: number) => {\n    if (confirm(\"ŸáŸÑ ÿ™ŸÖ ÿ•ÿÆÿ∑ÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑŸÖÿ™ÿ∂ÿ±ÿ±ŸäŸÜÿü\")) {\n      updateIncidentMutation.mutate({\n        incidentId,\n        reportedToUsersAt: new Date(),\n      });\n    }\n  };\n\n  if (loading || isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (!user || user.role !== \"admin\") {\n    setLocation(\"/\");\n    return null;\n  }\n\n  const getRiskBadge = (level: string) => {\n    const variants: Record<string, any> = {\n      low: {\n        variant: \"secondary\",\n        label: \"ŸÖŸÜÿÆŸÅÿ∂\",\n        className: \"bg-green-100 text-green-800\",\n      },\n      medium: {\n        variant: \"default\",\n        label: \"ŸÖÿ™Ÿàÿ≥ÿ∑\",\n        className: \"bg-amber-100 text-amber-800\",\n      },\n      high: {\n        variant: \"destructive\",\n        label: \"ÿπÿßŸÑŸä\",\n        className: \"bg-red-100 text-red-800\",\n      },\n    };\n    const config = variants[level] || variants.medium;\n\n    return <Badge className={config.className}>{config.label}</Badge>;\n  };\n\n  const getStatusBadge = (status: string) => {\n    const variants: Record<string, any> = {\n      new: { label: \"ÿ¨ÿØŸäÿØ\", className: \"bg-blue-100 text-blue-800\" },\n      investigating: {\n        label: \"ŸÇŸäÿØ ÿßŸÑÿ™ÿ≠ŸÇŸäŸÇ\",\n        className: \"bg-purple-100 text-purple-800\",\n      },\n      reported: {\n        label: \"ÿ™ŸÖ ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫\",\n        className: \"bg-amber-100 text-amber-800\",\n      },\n      resolved: { label: \"ŸÖÿ≠ŸÑŸàŸÑ\", className: \"bg-green-100 text-green-800\" },\n    };\n    const config = variants[status] || variants.new;\n\n    return <Badge className={config.className}>{config.label}</Badge>;\n  };\n\n  const getHoursRemaining = (detectedAt: string) => {\n    const detected = new Date(detectedAt);\n    const now = new Date();\n    const diffHours = Math.floor(\n      (now.getTime() - detected.getTime()) / (1000 * 60 * 60)\n    );\n    const remaining = 72 - diffHours;\n\n    if (remaining < 0) {\n      return (\n        <span className=\"text-red-600 font-semibold\">\n          ŸÖÿ™ÿ£ÿÆÿ± {Math.abs(remaining)} ÿ≥ÿßÿπÿ© ‚ö†Ô∏è\n        </span>\n      );\n    } else if (remaining <= 12) {\n      return (\n        <span className=\"text-amber-600 font-semibold\">\n          ŸÖÿ™ÿ®ŸÇŸä {remaining} ÿ≥ÿßÿπÿ©\n        </span>\n      );\n    } else {\n      return (\n        <span className=\"text-muted-foreground\">ŸÖÿ™ÿ®ŸÇŸä {remaining} ÿ≥ÿßÿπÿ©</span>\n      );\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-red-50 via-white to-orange-50 py-12 px-4\">\n      <div className=\"container max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-4xl font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent mb-2\">\n              ÿßŸÑÿ≠ŸàÿßÿØÿ´ ÿßŸÑÿ£ŸÖŸÜŸäÿ©\n            </h1>\n            <p className=\"text-muted-foreground\">\n              ÿ•ÿØÿßÿ±ÿ© ÿÆÿ±ŸàŸÇÿßÿ™ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ (ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿÆŸÑÿßŸÑ 72 ÿ≥ÿßÿπÿ©)\n            </p>\n          </div>\n\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"bg-red-600 hover:bg-red-700\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ≠ÿßÿØÿ´ ÿ¨ÿØŸäÿØ\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"max-w-2xl\">\n              <DialogHeader>\n                <DialogTitle>ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ≠ÿßÿØÿ´ ÿ£ŸÖŸÜŸä ÿ¨ÿØŸäÿØ</DialogTitle>\n                <DialogDescription>\n                  ÿßŸÖŸÑÿ£ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖÿ™ÿπŸÑŸÇÿ© ÿ®ÿßŸÑÿ≠ÿßÿØÿ´. ÿ≥Ÿäÿ®ÿØÿ£ ÿßŸÑÿπÿØ ÿßŸÑÿ™ŸÜÿßÿ≤ŸÑŸä ŸÑŸÑŸÄ\n                  72 ÿ≥ÿßÿπÿ© ŸÅŸàÿ±ÿßŸã.\n                </DialogDescription>\n              </DialogHeader>\n\n              <div className=\"space-y-4 py-4\">\n                <div>\n                  <Label htmlFor=\"description\">ŸàÿµŸÅ ÿßŸÑÿ≠ÿßÿØÿ´ *</Label>\n                  <Textarea\n                    id=\"description\"\n                    placeholder=\"ÿßÿ¥ÿ±ÿ≠ ŸÖÿß ÿ≠ÿØÿ´ ÿ®ÿßŸÑÿ™ŸÅÿµŸäŸÑ...\"\n                    value={description}\n                    onChange={e => setDescription(e.target.value)}\n                    rows={4}\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"cause\">ÿßŸÑÿ≥ÿ®ÿ® (ÿ•ŸÜ ŸÉÿßŸÜ ŸÖÿπÿ±ŸàŸÅÿßŸã)</Label>\n                  <Textarea\n                    id=\"cause\"\n                    placeholder=\"ŸÖÿß ÿßŸÑÿ∞Ÿä ÿ™ÿ≥ÿ®ÿ® ŸÅŸä ÿßŸÑÿ≠ÿßÿØÿ´ÿü\"\n                    value={cause}\n                    onChange={e => setCause(e.target.value)}\n                    rows={3}\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"categories\">ŸÅÿ¶ÿßÿ™ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ™ÿ£ÿ´ÿ±ÿ©</Label>\n                  <Input\n                    id=\"categories\"\n                    placeholder=\"ŸÖÿ´ÿßŸÑ: ÿ£ÿ≥ŸÖÿßÿ°ÿå ÿ£ÿ±ŸÇÿßŸÖ ŸáŸàÿßÿ™ŸÅÿå ÿπŸÜÿßŸàŸäŸÜ\"\n                    value={affectedDataCategories}\n                    onChange={e => setAffectedDataCategories(e.target.value)}\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"usersCount\">\n                    ÿπÿØÿØ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑŸÖÿ™ÿ£ÿ´ÿ±ŸäŸÜ (ÿ™ŸÇÿ±Ÿäÿ®Ÿä)\n                  </Label>\n                  <Input\n                    id=\"usersCount\"\n                    type=\"number\"\n                    placeholder=\"0\"\n                    value={affectedUsersCount}\n                    onChange={e => setAffectedUsersCount(e.target.value)}\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"riskLevel\">ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿÆÿ∑Ÿàÿ±ÿ© *</Label>\n                  <Select\n                    value={riskLevel}\n                    onValueChange={(value: any) => setRiskLevel(value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"low\">ŸÖŸÜÿÆŸÅÿ∂</SelectItem>\n                      <SelectItem value=\"medium\">ŸÖÿ™Ÿàÿ≥ÿ∑</SelectItem>\n                      <SelectItem value=\"high\">ÿπÿßŸÑŸä</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <Button\n                  onClick={handleCreateIncident}\n                  disabled={createIncidentMutation.isPending}\n                  className=\"w-full\"\n                >\n                  ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿßÿØÿ´\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid md:grid-cols-4 gap-4 mb-6\">\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-3xl font-bold text-red-600\">\n                  {data?.incidents?.filter((i: any) => {\n                    const detected = new Date(i.detectedAt);\n                    const now = new Date();\n                    const diffHours = Math.floor(\n                      (now.getTime() - detected.getTime()) / (1000 * 60 * 60)\n                    );\n                    return diffHours > 72 && !i.reportedToSdaiaAt;\n                  }).length || 0}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  ŸÖÿ™ÿ£ÿÆÿ±ÿ© (72+ ÿ≥ÿßÿπÿ©)\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-3xl font-bold text-amber-600\">\n                  {data?.incidents?.filter(\n                    (i: any) => i.status === \"investigating\"\n                  ).length || 0}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  ŸÇŸäÿØ ÿßŸÑÿ™ÿ≠ŸÇŸäŸÇ\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-3xl font-bold text-blue-600\">\n                  {data?.incidents?.filter((i: any) => i.status === \"reported\")\n                    .length || 0}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-1\">ÿ™ŸÖ ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-3xl font-bold text-green-600\">\n                  {data?.incidents?.filter((i: any) => i.status === \"resolved\")\n                    .length || 0}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-1\">ŸÖÿ≠ŸÑŸàŸÑÿ©</p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Incidents List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸàÿßÿØÿ´</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {!data?.incidents || data.incidents.length === 0 ? (\n              <div className=\"text-center py-12 text-muted-foreground\">\n                <Shield className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≠ŸàÿßÿØÿ´ ŸÖÿ≥ÿ¨ŸÑÿ© (Ÿáÿ∞ÿß ÿ¨ŸäÿØ! üéâ)</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {data.incidents.map((incident: any) => (\n                  <Card\n                    key={incident.id}\n                    className={`border-2 ${incident.isLate ? \"border-red-300 bg-red-50\" : \"\"}`}\n                  >\n                    <CardContent className=\"pt-6\">\n                      <div className=\"space-y-4\">\n                        <div className=\"flex items-start justify-between gap-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <AlertTriangle className=\"h-5 w-5 text-red-600\" />\n                              <h3 className=\"font-semibold\">\n                                ÿ≠ÿßÿØÿ´ #{incident.id}\n                              </h3>\n                              {getRiskBadge(incident.riskLevel)}\n                              {getStatusBadge(incident.status)}\n                              {incident.isLate && (\n                                <Badge className=\"bg-red-600 text-white\">\n                                  ŸÖÿ™ÿ£ÿÆÿ±!\n                                </Badge>\n                              )}\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">\n                              {incident.description}\n                            </p>\n                            {incident.cause && (\n                              <p className=\"text-sm bg-slate-100 p-2 rounded\">\n                                <strong>ÿßŸÑÿ≥ÿ®ÿ®:</strong> {incident.cause}\n                              </p>\n                            )}\n                          </div>\n\n                          <div className=\"text-right space-y-2\">\n                            <p className=\"text-sm text-muted-foreground\">\n                              {new Date(incident.detectedAt).toLocaleString(\n                                \"ar-SA\"\n                              )}\n                            </p>\n                            {!incident.reportedToSdaiaAt && (\n                              <p className=\"text-sm\">\n                                {getHoursRemaining(incident.detectedAt)}\n                              </p>\n                            )}\n                          </div>\n                        </div>\n\n                        <div className=\"grid md:grid-cols-2 gap-3\">\n                          {incident.affectedUsersCount && (\n                            <div className=\"flex items-center gap-2 text-sm\">\n                              <Users className=\"h-4 w-4 text-muted-foreground\" />\n                              <span>\n                                {incident.affectedUsersCount} ŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ™ÿ£ÿ´ÿ±\n                              </span>\n                            </div>\n                          )}\n                        </div>\n\n                        <div className=\"flex gap-2 pt-3 border-t\">\n                          {!incident.reportedToSdaiaAt && (\n                            <Button\n                              size=\"sm\"\n                              onClick={() => handleReportToSdaia(incident.id)}\n                              className=\"bg-red-600 hover:bg-red-700\"\n                            >\n                              <Send className=\"h-3 w-3 mr-1\" />\n                              ÿ•ÿ®ŸÑÿßÿ∫ ÿ≥ÿØÿßŸäÿß\n                            </Button>\n                          )}\n                          {incident.reportedToSdaiaAt &&\n                            !incident.reportedToUsersAt && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={() => handleReportToUsers(incident.id)}\n                              >\n                                <Send className=\"h-3 w-3 mr-1\" />\n                                ÿ•ÿÆÿ∑ÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ\n                              </Button>\n                            )}\n                          {incident.reportedToSdaiaAt && (\n                            <Badge\n                              variant=\"secondary\"\n                              className=\"flex items-center gap-1\"\n                            >\n                              <CheckCircle className=\"h-3 w-3\" />\n                              ÿ™ŸÖ ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ŸÑÿ≥ÿØÿßŸäÿß\n                            </Badge>\n                          )}\n                          {incident.reportedToUsersAt && (\n                            <Badge\n                              variant=\"secondary\"\n                              className=\"flex items-center gap-1\"\n                            >\n                              <CheckCircle className=\"h-3 w-3\" />\n                              ÿ™ŸÖ ÿ•ÿÆÿ∑ÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Warning */}\n        <Card className=\"mt-6 bg-red-50 border-red-200\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex gap-3\">\n              <AlertCircle className=\"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5\" />\n              <div className=\"space-y-2 text-sm text-red-900\">\n                <p className=\"font-semibold\">ÿ™ÿ≠ÿ∞Ÿäÿ± ŸáÿßŸÖ - ŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ PDPL:</p>\n                <ul className=\"list-disc list-inside space-y-1 mr-4\">\n                  <li>\n                    <strong>72 ÿ≥ÿßÿπÿ©:</strong> Ÿäÿ¨ÿ® ÿ•ÿ®ŸÑÿßÿ∫ ÿ≥ÿØÿßŸäÿß ÿπŸÜ ÿ£Ÿä ÿÆÿ±ŸÇ ÿÆŸÑÿßŸÑ 72\n                    ÿ≥ÿßÿπÿ© ŸÖŸÜ ÿßŸÉÿ™ÿ¥ÿßŸÅŸá\n                  </li>\n                  <li>\n                    <strong>ÿ•ÿÆÿ∑ÿßÿ± ÿßŸÑŸÖÿ™ÿ∂ÿ±ÿ±ŸäŸÜ:</strong> Ÿäÿ¨ÿ® ÿ•ÿÆÿ∑ÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ\n                    ÿßŸÑŸÖÿ™ÿ£ÿ´ÿ±ŸäŸÜ ÿ®ÿØŸàŸÜ ÿ™ÿ£ÿÆŸäÿ± ÿ∫Ÿäÿ± ŸÖÿ®ÿ±ÿ±\n                  </li>\n                  <li>\n                    <strong>ÿßŸÑÿ™Ÿàÿ´ŸäŸÇ:</strong> Ÿäÿ¨ÿ® ÿ™Ÿàÿ´ŸäŸÇ ÿ¨ŸÖŸäÿπ ÿßŸÑÿÆÿ±ŸàŸÇÿßÿ™ ÿ≠ÿ™Ÿâ ŸÑŸà ŸÑŸÖ\n                    ÿ™ÿ™ÿ∑ŸÑÿ® ÿ•ÿ®ŸÑÿßÿ∫ ÿ≥ÿØÿßŸäÿß\n                  </li>\n                  <li>\n                    <strong>ÿßŸÑÿπŸÇŸàÿ®ÿßÿ™:</strong> ÿßŸÑÿ™ÿ£ÿÆŸäÿ± ŸÅŸä ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ŸÇÿØ Ÿäÿπÿ±ÿ∂ ÿßŸÑŸÖŸÜÿµÿ©\n                    ŸÑÿ∫ÿ±ÿßŸÖÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ©\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":["AdminSecurityIncidents","user","loading","useAuth","setLocation","useLocation","isDialogOpen","setIsDialogOpen","useState","description","setDescription","cause","setCause","affectedDataCategories","setAffectedDataCategories","affectedUsersCount","setAffectedUsersCount","riskLevel","setRiskLevel","data","isLoading","refetch","trpc","createIncidentMutation","toast","resetForm","updateIncidentMutation","handleCreateIncident","handleReportToSdaia","incidentId","handleReportToUsers","jsx","getRiskBadge","level","variants","config","Badge","getStatusBadge","status","getHoursRemaining","detectedAt","detected","remaining","jsxs","Dialog","DialogTrigger","Button","Plus","DialogContent","DialogHeader","DialogTitle","DialogDescription","Label","Textarea","e","Input","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","Card","CardContent","i","CardHeader","CardTitle","Shield","incident","AlertTriangle","Users","Send","CheckCircle","AlertCircle"],"mappings":"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"}