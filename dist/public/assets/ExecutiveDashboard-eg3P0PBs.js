import{r as m,j as e}from"./ui-vendor-C96WIwkg.js";import{D as B}from"./DashboardLayout-BL5EQdI4.js";import{h as k,n as T,t as M,C as i,c as n,d as o,e as x,f as c,T as _,B as O}from"./index-Bkz6h1fQ.js";import{B as j}from"./badge-DdDRUR73.js";import{T as I,a as V,b as v,c as y}from"./tabs-CacS76o1.js";import{S as z}from"./switch-B5HFmlbk.js";import{S as G}from"./separator-DBdTAbb0.js";import{S as d}from"./skeleton-CH6Aula-.js";import{C as J}from"./chart-column-D_-lOMZP.js";import{Z as Q}from"./zap-lVjBWbjN.js";import{A as U}from"./activity-C1zJzqij.js";import{T as Z}from"./trending-up-Bx2v0sIc.js";import{B as K}from"./bell-ring-D5a7BXyT.js";import{C as w}from"./clock-BFXiIUou.js";import"./react-vendor-DDxydHEc.js";import"./briefcase-B7DqEMtf.js";import"./shield-check-CohldUcE.js";import"./bell-BqXFjnTJ.js";import"./query-vendor-Dpt6u7bR.js";import"./chart-vendor-8DIN3ZwM.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=k("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=k("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),q={default:"text-foreground border border-border bg-background [&>[data-slot=alert-title]]:text-foreground",destructive:"text-destructive border border-destructive/50 bg-destructive/10 [&>[data-slot=alert-title]]:text-destructive"},p=m.forwardRef(({className:a,variant:r="default",...l},b)=>e.jsx("div",{ref:b,role:"alert","data-slot":"alert",className:T("relative w-full rounded-lg px-4 py-3 text-sm transition-colors",q[r],a),...l}));p.displayName="Alert";const g=m.forwardRef(({className:a,...r},l)=>e.jsx("div",{ref:l,"data-slot":"alert-title",className:T("mb-1 font-semibold leading-none tracking-tight",a),...r}));g.displayName="AlertTitle";const f=m.forwardRef(({className:a,...r},l)=>e.jsx("p",{ref:l,"data-slot":"alert-description",className:T("text-sm leading-relaxed",a),...r}));f.displayName="AlertDescription";const P={execDashboard:!0,anomalyAlerts:!0,experimentalTours:!0},F="rabit_feature_flags",D=()=>{if(typeof window>"u")return{};try{const a=localStorage.getItem(F);if(!a)return{};const r=JSON.parse(a);return r&&typeof r=="object"?r:{}}catch{return{}}},W=a=>{if(!(typeof window>"u"))try{localStorage.setItem(F,JSON.stringify(a))}catch{}};function L(){const a=D();return{...P,...a}}function X(a,r){const l=D();l[a]=r,W(l)}function S(a){return L()[a]}function C(){const a=L();return Object.keys(a).map(r=>({key:r,enabled:a[r]}))}function Ne(){const[a,r]=m.useState(C()),[l,b]=m.useState("overview"),N=S("anomalyAlerts"),h=S("execDashboard"),t=M.dashboard.executive.useQuery(void 0,{enabled:h||N,staleTime:3e4}),R=s=>s==="high"?"text-red-600 bg-red-50 border-red-200":s==="medium"?"text-amber-600 bg-amber-50 border-amber-200":"text-blue-600 bg-blue-50 border-blue-200",E=s=>{const u=a.find($=>$.key===s)?.enabled??!1;X(s,!u),r(C())},H=m.useMemo(()=>{const s=t.data?.metrics;return!h||!s?[]:[{label:"وقت ملء الوظيفة",value:`${s.timeToFillDays} يوم`,delta:`${Math.abs(s.timeToFillDelta)} يوم`,deltaTone:s.timeToFillDelta<=0?"up":"down",hint:"المستهدف < 25 يوم"},{label:"وقت حل التذاكر",value:`${s.timeToResolveHours} ساعة`,delta:`${Math.abs(s.timeToResolveHours-12)} ساعة`,deltaTone:s.timeToResolveHours<=12?"up":"down",hint:"المستهدف < 12 ساعة"},{label:"عائد الاستشارات",value:`﷼ ${Number(s.consultingRevenueSar||0).toLocaleString("ar-SA")}`,delta:"+12%",deltaTone:"up",hint:"نمو أسبوعي"},{label:"نسبة قبول العرض",value:`${s.offerAcceptanceRate}%`,delta:s.offerAcceptanceRate>=85?"+3%":"-6%",deltaTone:s.offerAcceptanceRate>=85?"up":"down",hint:"المستهدف > 85%"}]},[h,t.isLoading,t.data?.metrics]);return e.jsx(B,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(J,{className:"h-7 w-7 text-purple-600"}),"لوحة تنفيذية"]}),e.jsx("p",{className:"text-muted-foreground",children:"مؤشرات التوظيف، القضايا، والاستشارات مع تنبيهات الشذوذ."})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:e.jsxs(j,{variant:"secondary",className:"gap-1",children:[e.jsx(Q,{className:"h-4 w-4"}),"تجريبية عبر Feature Flags"]})})]}),e.jsxs(i,{children:[e.jsxs(n,{className:"pb-3",children:[e.jsx(o,{className:"text-lg",children:"Feature Flags"}),e.jsx(x,{children:"تشغيل/إيقاف الميزات التجريبية للمؤشرات والتنبيهات."})]}),e.jsx(c,{className:"grid md:grid-cols-3 gap-4",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between border rounded-lg px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.key}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.key==="execDashboard"?"تفعيل اللوحة التنفيذية":s.key==="anomalyAlerts"?"تفعيل تنبيهات الشذوذ":"تجارب الجولات الموجهة"})]}),e.jsx(z,{checked:s.enabled,onCheckedChange:()=>E(s.key)})]},s.key))})]}),e.jsxs(I,{value:l,onValueChange:b,className:"space-y-4",children:[e.jsxs(V,{children:[e.jsx(v,{value:"overview",children:"نظرة عامة"}),e.jsx(v,{value:"anomalies",children:"تنبيهات الشذوذ"}),e.jsx(v,{value:"sla",children:"SLA"})]}),e.jsxs(y,{value:"overview",className:"space-y-4",children:[!h&&e.jsxs(p,{variant:"destructive",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(g,{children:"اللوحة التنفيذية غير مفعلة"}),e.jsx(f,{children:"فعّل علم execDashboard أعلاه لعرض المؤشرات."})]}),h&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.isLoading&&Array.from({length:4}).map((s,u)=>e.jsxs(i,{children:[e.jsxs(n,{className:"pb-1 space-y-2",children:[e.jsx(d,{className:"h-4 w-32"}),e.jsx(d,{className:"h-6 w-16"})]}),e.jsxs(c,{className:"space-y-2",children:[e.jsx(d,{className:"h-4 w-20"}),e.jsx(d,{className:"h-3 w-32"})]})]},u)),!t.isLoading&&H.map(s=>e.jsxs(i,{children:[e.jsxs(n,{className:"pb-1",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-purple-600"}),s.label]}),e.jsx(o,{className:"text-2xl",children:s.value})]}),e.jsxs(c,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`text-sm font-semibold flex items-center gap-1 ${s.deltaTone==="up"?"text-green-600":"text-red-600"}`,children:[s.deltaTone==="up"?e.jsx(Z,{className:"h-4 w-4"}):e.jsx(Y,{className:"h-4 w-4"}),s.delta]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.hint})]})]},s.label))]}),!t.isLoading&&t.data?.metrics&&e.jsxs("div",{className:"flex flex-wrap gap-6 text-sm text-muted-foreground pl-1",children:[e.jsxs("span",{children:["حجوزات معلقة: ",e.jsx("strong",{children:t.data.metrics.pendingConsultations})]}),e.jsxs("span",{children:["حجوزات مكتملة: ",e.jsx("strong",{children:t.data.metrics.completedConsultations})]}),e.jsxs("span",{children:["تذاكر معلقة: ",e.jsx("strong",{children:t.data.metrics.pendingTickets})]})]})]})]}),e.jsxs(y,{value:"anomalies",className:"space-y-4",children:[!N&&e.jsxs(p,{variant:"destructive",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx(g,{children:"تنبيهات الشذوذ غير مفعلة"}),e.jsx(f,{children:"فعّل علم anomalyAlerts لرؤية التنبيهات."})]}),N&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.isLoading&&Array.from({length:2}).map((s,u)=>e.jsxs(i,{className:"border",children:[e.jsxs(n,{className:"space-y-2",children:[e.jsx(d,{className:"h-4 w-40"}),e.jsx(d,{className:"h-3 w-56"})]}),e.jsxs(c,{className:"flex items-center justify-between",children:[e.jsx(d,{className:"h-6 w-16"}),e.jsx(d,{className:"h-8 w-20"})]})]},u)),!t.isLoading&&(t.data?.anomalies??[]).map(s=>e.jsxs(i,{className:`border ${R(s.severity)}`,children:[e.jsxs(n,{className:"pb-2",children:[e.jsxs(o,{className:"flex items-center gap-2 text-base",children:[s.severity==="high"?e.jsx(_,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"}),s.title]}),e.jsx(x,{children:s.detail})]}),e.jsxs(c,{className:"flex items-center justify-between",children:[e.jsx(j,{variant:"outline",children:s.severity==="high"?"مرتفع":s.severity==="medium"?"متوسط":"منخفض"}),e.jsx(O,{variant:"outline",size:"sm",children:s.action})]})]},s.title))]})]}),e.jsxs(y,{value:"sla",className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-blue-600"}),"SLA التوظيف"]}),e.jsxs(x,{children:["الرد الأول ",t.data?.sla?.hiring.firstResponseHours??24," ساعة، القرار ",t.data?.sla?.hiring.decisionDays??7," أيام"]})]}),e.jsxs(c,{className:"flex items-center justify-between",children:[e.jsx(j,{children:"قيد المتابعة"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"المستهدف 95% التزام"})]})]}),e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-green-600"}),"SLA التذاكر"]}),e.jsxs(x,{children:["الرد الأول ",t.data?.sla?.tickets.firstResponseHours??4," ساعة، الحل ",t.data?.sla?.tickets.resolutionHours??24," ساعة"]})]}),e.jsxs(c,{className:"flex items-center justify-between",children:[e.jsx(j,{variant:"secondary",children:"مستقر"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"المستهدف 90% التزام"})]})]}),e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-purple-600"}),"SLA الاستشارات"]}),e.jsxs(x,{children:["الرد الأول ",t.data?.sla?.consulting.firstResponseHours??8," ساعة، التسليم ",t.data?.sla?.consulting.deliveryHours??48," ساعة"]})]}),e.jsxs(c,{className:"flex items-center justify-between",children:[e.jsx(j,{variant:"outline",children:"تحت المراجعة"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["المستهدف ",t.data?.sla?.targetCompliance??92,"% التزام"]})]})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs(p,{children:[e.jsx(g,{children:"اقتراح تحسين"}),e.jsx(f,{children:"فعّل تنبيه دفع فوري لإعادة محاولة التحصيل بعد 15 دقيقة للحالات المتعثرة."})]}),e.jsxs(p,{children:[e.jsx(g,{children:"انخفاض نشاط مستشارين"}),e.jsx(f,{children:"جدولة ترويج تلقائي لحزم الاستشارة للمستشارين الخاملين خلال 7 أيام."})]})]})]})]})]})})}export{Ne as default};
