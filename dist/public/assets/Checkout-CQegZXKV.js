import{r as c,H as z,J as he,p as fe,j as e,q as Y,K as je,s as _,u as q,M as ve,t as T,N as Ne,v as ge,w as ye}from"./ui-vendor-C96WIwkg.js";import{n as J,a as be,t as k,C as A,c as I,d as L,f as P,I as C,K as Re,B as G,k as Q,S as Ce,b as w}from"./index-Bkz6h1fQ.js";import{B as we}from"./BackButton-rFUz39lD.js";import{L as v}from"./label-CmhXhWbA.js";import{S as M}from"./separator-DBdTAbb0.js";import{B as D}from"./badge-DdDRUR73.js";import{B as Se}from"./building-2-Dknnor09.js";import{A as ke}from"./arrow-right-yQLf5R-N.js";import{L as Ae}from"./lock-CN3EPsKv.js";import{S as $}from"./shield-D1nyOWBv.js";import{C as B}from"./circle-check-DlUG-57U.js";import{T as Pe}from"./tag-D3Y8_vCl.js";import"./react-vendor-DDxydHEc.js";import"./query-vendor-Dpt6u7bR.js";import"./chart-vendor-8DIN3ZwM.js";import"./house-CS3RhUwS.js";var O="Radio",[De,W]=Y(O),[_e,Fe]=De(O),X=c.forwardRef((d,l)=>{const{__scopeRadio:r,name:o,checked:i=!1,required:a,disabled:u,value:p="on",onCheck:n,form:h,...b}=d,[N,R]=c.useState(null),m=q(l,f=>R(f)),x=c.useRef(!1),t=N?h||!!N.closest("form"):!0;return e.jsxs(_e,{scope:r,checked:i,disabled:u,children:[e.jsx(_.button,{type:"button",role:"radio","aria-checked":i,"data-state":ae(i),"data-disabled":u?"":void 0,disabled:u,value:p,...b,ref:m,onClick:T(d.onClick,f=>{i||n?.(),t&&(x.current=f.isPropagationStopped(),x.current||f.stopPropagation())})}),t&&e.jsx(se,{control:N,bubbles:!x.current,name:o,value:p,checked:i,required:a,disabled:u,form:h,style:{transform:"translateX(-100%)"}})]})});X.displayName=O;var Z="RadioIndicator",ee=c.forwardRef((d,l)=>{const{__scopeRadio:r,forceMount:o,...i}=d,a=Fe(Z,r);return e.jsx(Ne,{present:o||a.checked,children:e.jsx(_.span,{"data-state":ae(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:l})})});ee.displayName=Z;var Ee="RadioBubbleInput",se=c.forwardRef(({__scopeRadio:d,control:l,checked:r,bubbles:o=!0,...i},a)=>{const u=c.useRef(null),p=q(u,a),n=ge(r),h=ye(l);return c.useEffect(()=>{const b=u.current;if(!b)return;const N=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(N,"checked").set;if(n!==r&&m){const x=new Event("click",{bubbles:o});m.call(b,r),b.dispatchEvent(x)}},[n,r,o]),e.jsx(_.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:p,style:{...i.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});se.displayName=Ee;function ae(d){return d?"checked":"unchecked"}var Ie=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],F="RadioGroup",[Le]=Y(F,[z,W]),re=z(),te=W(),[Ge,Me]=Le(F),ne=c.forwardRef((d,l)=>{const{__scopeRadioGroup:r,name:o,defaultValue:i,value:a,required:u=!1,disabled:p=!1,orientation:n,dir:h,loop:b=!0,onValueChange:N,...R}=d,m=re(r),x=he(h),[t,f]=fe({prop:a,defaultProp:i??null,onChange:N,caller:F});return e.jsx(Ge,{scope:r,name:o,required:u,disabled:p,value:t,onValueChange:f,children:e.jsx(je,{asChild:!0,...m,orientation:n,dir:x,loop:b,children:e.jsx(_.div,{role:"radiogroup","aria-required":u,"aria-orientation":n,"data-disabled":p?"":void 0,dir:x,...R,ref:l})})})});ne.displayName=F;var ce="RadioGroupItem",ie=c.forwardRef((d,l)=>{const{__scopeRadioGroup:r,disabled:o,...i}=d,a=Me(ce,r),u=a.disabled||o,p=re(r),n=te(r),h=c.useRef(null),b=q(l,h),N=a.value===i.value,R=c.useRef(!1);return c.useEffect(()=>{const m=t=>{Ie.includes(t.key)&&(R.current=!0)},x=()=>R.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",x),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",x)}},[]),e.jsx(ve,{asChild:!0,...p,focusable:!u,active:N,children:e.jsx(X,{disabled:u,required:a.required,checked:N,...n,...i,name:a.name,ref:b,onCheck:()=>a.onValueChange(i.value),onKeyDown:T(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:T(i.onFocus,()=>{R.current&&h.current?.click()})})})});ie.displayName=ce;var Be="RadioGroupIndicator",oe=c.forwardRef((d,l)=>{const{__scopeRadioGroup:r,...o}=d,i=te(r);return e.jsx(ee,{...i,...o,ref:l})});oe.displayName=Be;var de=ne,le=ie,Te=oe;const ue=c.forwardRef(({className:d,...l},r)=>e.jsx(de,{ref:r,className:J("grid gap-2",d),...l}));ue.displayName=de.displayName;const V=c.forwardRef(({className:d,children:l,...r},o)=>e.jsxs(le,{ref:o,className:J("aspect-square h-4 w-4 rounded-full border border-primary text-primary","focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-primary","disabled:cursor-not-allowed disabled:opacity-50",d),...r,children:[e.jsx(Te,{className:"flex items-center justify-center",children:e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-primary"})}),l]}));V.displayName=le.displayName;function as(){const[,d]=be(),[l,r]=c.useState(!1),[o,i]=c.useState("credit_card"),[a]=c.useState({id:"professional",name:"الباقة الاحترافية",price:1499,originalPrice:1999,discount:25,features:["حتى 50 موظف","جميع أدوات HR","تقارير متقدمة","دعم فني مباشر","استشارة مجانية شهرياً","تكامل مع الأنظمة الحكومية"]}),[u,p]=c.useState(""),[n,h]=c.useState(null),b=k.payment.createMoyasarPayment.useMutation(),N=k.payment.createTapPayment.useMutation(),R=k.discountCodes.validate.useQuery({code:u},{enabled:!1,retry:!1}),m=k.discountCodes.calculateDiscount.useQuery({code:u,originalAmount:a.price},{enabled:!1,retry:!1}),x=R.isFetching||m.isFetching,[t,f]=c.useState({fullName:"",email:"",phone:"",companyName:"",taxNumber:"",address:""}),[g,S]=c.useState({cardNumber:"",cardName:"",expiryDate:"",cvv:""}),me=()=>n?n.finalAmount:a.price,xe=async()=>{const s=u.trim().toUpperCase();if(!s){w.error("الرجاء إدخال كود الخصم");return}p(s),h(null);try{const j=await R.refetch({throwOnError:!0});if(!j.data?.valid){w.error(j.data?.message||"كود الخصم غير صالح");return}const y=await m.refetch({throwOnError:!0});if(!y.data){w.error("تعذر حساب قيمة الخصم");return}h({code:s,discountAmount:y.data.discountAmount,discountType:y.data.discountType,discountValue:y.data.discountValue,finalAmount:y.data.finalAmount}),w.success("تم تطبيق كود الخصم بنجاح!")}catch(j){const y=j instanceof Error?j.message:"كود الخصم غير صالح";w.error(y)}},pe=()=>{h(null),p("")},U=async s=>{if(s.preventDefault(),!t.fullName||!t.email||!t.phone){w.error("الرجاء إكمال جميع البيانات المطلوبة");return}if(o==="credit_card"&&(!g.cardNumber||!g.cardName||!g.expiryDate||!g.cvv)){w.error("الرجاء إكمال بيانات البطاقة");return}r(!0);try{const j={planKey:a.id,amount:E,discountCode:n?.code,customerEmail:t.email},y=o==="credit_card"?await b.mutateAsync(j):await N.mutateAsync(j);if(y?.redirectUrl){window.location.href=y.redirectUrl;return}w.success("تمت عملية الدفع بنجاح!"),d("/payment-success")}catch(j){const y=j instanceof Error?j.message:"حدث خطأ أثناء معالجة الدفع";w.error(y)}finally{r(!1)}},K=me(),H=K*.15,E=K+H;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-primary/10 to-primary/5 py-12",children:[e.jsx(we,{}),e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"إتمام عملية الدفع"}),e.jsx("p",{className:"text-muted-foreground",children:"أنت على بعد خطوة واحدة من الانضمام إلى منصة رابِط"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(A,{children:[e.jsx(I,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"معلومات الفوترة"]})}),e.jsx(P,{children:e.jsx("form",{onSubmit:U,className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"fullName",children:["الاسم الكامل ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"fullName",value:t.fullName,onChange:s=>f({...t,fullName:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"email",children:["البريد الإلكتروني"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"email",type:"email",value:t.email,onChange:s=>f({...t,email:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"phone",children:["رقم الجوال ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"phone",type:"tel",placeholder:"05xxxxxxxx",value:t.phone,onChange:s=>f({...t,phone:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"companyName",children:"اسم الشركة"}),e.jsx(C,{id:"companyName",value:t.companyName,onChange:s=>f({...t,companyName:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"taxNumber",children:"الرقم الضريبي"}),e.jsx(C,{id:"taxNumber",placeholder:"300xxxxxxxxx",value:t.taxNumber,onChange:s=>f({...t,taxNumber:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"address",children:"العنوان"}),e.jsx(C,{id:"address",value:t.address,onChange:s=>f({...t,address:s.target.value})})]})]})})})]}),e.jsxs(A,{children:[e.jsx(I,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),"طريقة الدفع"]})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs(ue,{value:o,onValueChange:s=>i(s),children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse p-4 border rounded-lg cursor-pointer hover:bg-muted/50",children:[e.jsx(V,{value:"credit_card",id:"credit_card"}),e.jsx(v,{htmlFor:"credit_card",className:"flex-1 cursor-pointer",children:"بطاقة الائتمان / مدى"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"secondary",children:"Visa"}),e.jsx(D,{variant:"secondary",children:"Mastercard"}),e.jsx(D,{variant:"secondary",children:"مدى"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse p-4 border rounded-lg cursor-pointer hover:bg-muted/50",children:[e.jsx(V,{value:"bank_transfer",id:"bank_transfer"}),e.jsx(v,{htmlFor:"bank_transfer",className:"flex-1 cursor-pointer",children:"تحويل بنكي"})]})]}),o==="credit_card"&&e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"cardNumber",children:"رقم البطاقة"}),e.jsx(C,{id:"cardNumber",placeholder:"1234 5678 9012 3456",maxLength:19,value:g.cardNumber,onChange:s=>S({...g,cardNumber:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"cardName",children:"اسم حامل البطاقة"}),e.jsx(C,{id:"cardName",placeholder:"كما هو مكتوب على البطاقة",value:g.cardName,onChange:s=>S({...g,cardName:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"expiryDate",children:"تاريخ الانتهاء"}),e.jsx(C,{id:"expiryDate",placeholder:"MM/YY",maxLength:5,value:g.expiryDate,onChange:s=>S({...g,expiryDate:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"cvv",children:"CVV"}),e.jsx(C,{id:"cvv",type:"password",placeholder:"123",maxLength:4,value:g.cvv,onChange:s=>S({...g,cvv:s.target.value})})]})]})]}),o==="bank_transfer"&&e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-3",children:[e.jsx("p",{className:"font-semibold",children:"معلومات الحساب البنكي:"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{children:"اسم البنك: البنك الأهلي السعودي"}),e.jsx("p",{children:"رقم الحساب: SA1234567890123456789012"}),e.jsx("p",{children:"اسم المستفيد: شركة رابِط للتقنية"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"يرجى إرفاق إثبات التحويل عند التواصل معنا"})]})]}),e.jsx(G,{type:"button",onClick:U,className:"w-full",size:"lg",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"ml-2 h-5 w-5 animate-spin"}),"جاري معالجة الدفع..."]}):e.jsxs(e.Fragment,{children:["إتمام الدفع - ",E.toFixed(2)," ﷼",e.jsx(ke,{className:"mr-2 h-5 w-5"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsx("span",{children:"تشفير SSL آمن"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),e.jsx("span",{children:"PCI DSS معتمد"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(I,{children:e.jsx(L,{children:"ملخص الطلب"})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"اشتراك شهري"})]}),e.jsxs("div",{className:"text-left",children:[a.discount>0&&e.jsxs("p",{className:"text-sm text-muted-foreground line-through",children:[a.originalPrice," ﷼"]}),e.jsxs("p",{className:"font-semibold",children:[a.price," ﷼"]})]})]}),a.discount>0&&e.jsxs(D,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(Ce,{className:"w-3 h-3 ml-1"}),"خصم ",a.discount,"%"]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[a.features.slice(0,3).map((s,j)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),s]},j)),a.features.length>3&&e.jsxs("li",{className:"text-primary",children:["+",a.features.length-3," ميزة أخرى"]})]})]}),e.jsx(M,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"discount",children:"كود الخصم"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{id:"discount",placeholder:"أدخل الكود",value:u,onChange:s=>p(s.target.value.toUpperCase()),disabled:!!n||x}),e.jsx(G,{type:"button",variant:"outline",onClick:xe,disabled:!!n||x,children:x?e.jsx(Q,{className:"h-4 w-4 animate-spin"}):e.jsx(Pe,{className:"h-4 w-4"})}),n&&e.jsx(G,{type:"button",variant:"ghost",onClick:pe,children:"إزالة"})]}),n&&e.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[e.jsx(B,{className:"h-4 w-4"}),"تم تطبيق خصم"," ",n.discountType==="percentage"?`${n.discountValue}%`:`${n.discountAmount.toFixed(2)} ﷼`]})]}),e.jsx(M,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"المجموع الفرعي"}),e.jsxs("span",{children:[a.price.toFixed(2)," ﷼"]})]}),n&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"الخصم"}),e.jsxs("span",{children:["- ",n.discountAmount.toFixed(2)," ﷼"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"الضريبة المضافة (15%)"}),e.jsxs("span",{children:[H.toFixed(2)," ﷼"]})]}),e.jsx(M,{}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"المجموع الإجمالي"}),e.jsxs("span",{children:[E.toFixed(2)," ﷼"]})]})]}),e.jsx("div",{className:"bg-primary/5 p-3 rounded-lg text-sm text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"سيتم تجديد الاشتراك تلقائياً كل شهر"})})]})]}),e.jsx(A,{className:"bg-muted/30",children:e.jsxs(P,{className:"pt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($,{className:"h-5 w-5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:"معاملات آمنة 100%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"جميع البيانات مشفرة بتقنية SSL"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:"ضمان استرجاع الأموال"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"في حال عدم الرضا خلال 14 يوم"})]})]})]})})]})]})]})]})}export{as as default};
