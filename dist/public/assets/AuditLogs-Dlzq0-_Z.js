import{r as l,j as e}from"./ui-vendor-C96WIwkg.js";import{B as f,C as n,f as d,T as N,c as v,d as g,e as b,I as y,U as w}from"./index-Bkz6h1fQ.js";import{B as o}from"./badge-DdDRUR73.js";import{T as C,a as S,b as h,c as r,d as T,e as a}from"./table-Cq_j4dL4.js";import{S as B,a as I,b as A,c as D,d as x}from"./select-B0y6YODy.js";import{D as H}from"./download-BYvKutrd.js";import{S as V}from"./shield-D1nyOWBv.js";import{C as k}from"./clock-BFXiIUou.js";import{F as E}from"./filter-CfJs4U0W.js";import"./react-vendor-DDxydHEc.js";import"./query-vendor-Dpt6u7bR.js";import"./chart-vendor-8DIN3ZwM.js";const F=[{id:1,actor:"admin@rabit.com",action:"تحديث صلاحيات مستخدم",entity:"user: 104",severity:"info",timestamp:"2025-01-20 10:25",ip:"192.168.1.12"},{id:2,actor:"security@rabit.com",action:"محاولة تسجيل دخول فاشلة",entity:"admin@demo",severity:"warn",timestamp:"2025-01-20 09:40",ip:"10.0.0.3"},{id:3,actor:"ops@rabit.com",action:"حذف تذكرة دعم",entity:"ticket: 552",severity:"error",timestamp:"2025-01-19 18:10",ip:"172.16.1.8"}];function W(){const[t]=l.useState(F),[c,j]=l.useState("all"),[i,p]=l.useState(""),u=l.useMemo(()=>t.filter(s=>!(c!=="all"&&s.severity!==c||i&&!s.action.includes(i)&&!s.actor.includes(i))),[t,c,i]),m=l.useMemo(()=>({total:t.length,warn:t.filter(s=>s.severity==="warn").length,error:t.filter(s=>s.severity==="error").length}),[t]);return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"سجلات التدقيق"}),e.jsx("p",{className:"text-muted-foreground",children:"مراقبة التغييرات، محاولات الدخول، والعمليات الحساسة."})]}),e.jsxs(f,{variant:"outline",children:[e.jsx(H,{className:"h-4 w-4 ml-2"}),"تصدير CSV"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(n,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(V,{className:"h-6 w-6 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"إجمالي الأحداث"}),e.jsx("p",{className:"text-2xl font-bold",children:m.total})]})]})}),e.jsx(n,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(N,{className:"h-6 w-6 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"تحذيرات"}),e.jsx("p",{className:"text-2xl font-bold",children:m.warn})]})]})}),e.jsx(n,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(k,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"أخطاء حرجة"}),e.jsx("p",{className:"text-2xl font-bold",children:m.error})]})]})})]}),e.jsxs(n,{children:[e.jsxs(v,{children:[e.jsx(g,{children:"سجل النشاطات"}),e.jsx(b,{children:"فلترة حسب الخطورة أو البحث عن مستخدم/حدث"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs(B,{value:c,onValueChange:s=>j(s),children:[e.jsx(I,{className:"w-48",children:e.jsx(A,{placeholder:"الخطورة"})}),e.jsxs(D,{children:[e.jsx(x,{value:"all",children:"الكل"}),e.jsx(x,{value:"info",children:"معلوماتي"}),e.jsx(x,{value:"warn",children:"تحذيري"}),e.jsx(x,{value:"error",children:"حرج"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-72",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(y,{placeholder:"بحث في الأحداث أو المستخدم",value:i,onChange:s=>p(s.target.value)})]})]}),e.jsxs(C,{children:[e.jsx(S,{children:e.jsxs(h,{children:[e.jsx(r,{className:"text-right",children:"المستخدم"}),e.jsx(r,{className:"text-right",children:"الإجراء"}),e.jsx(r,{className:"text-right",children:"الكائن"}),e.jsx(r,{className:"text-right",children:"الوقت"}),e.jsx(r,{className:"text-right",children:"IP"}),e.jsx(r,{className:"text-right",children:"الحالة"})]})}),e.jsx(T,{children:u.map(s=>e.jsxs(h,{children:[e.jsxs(a,{className:"font-medium flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-purple-600"}),s.actor]}),e.jsx(a,{children:s.action}),e.jsx(a,{children:e.jsx(o,{variant:"outline",children:s.entity})}),e.jsx(a,{children:s.timestamp}),e.jsx(a,{children:s.ip}),e.jsx(a,{children:e.jsx(o,{className:s.severity==="error"?"bg-red-100 text-red-700":s.severity==="warn"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-700",children:s.severity})})]},s.id))})]})]})]})]})}export{W as default};
