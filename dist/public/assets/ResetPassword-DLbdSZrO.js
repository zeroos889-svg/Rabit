import{r as a,j as s}from"./ui-vendor-C96WIwkg.js";import{B as R}from"./BackButton-rFUz39lD.js";import{g as z,a as I,t as q,C as M,c as T,d as Z,e as $,f as H,L as j,B as d,I as N,k as O,b as l}from"./index-Bkz6h1fQ.js";import{L as b}from"./label-CmhXhWbA.js";import{L as m}from"./lock-CN3EPsKv.js";import{C as x}from"./circle-check-DlUG-57U.js";import{A as y}from"./arrow-right-yQLf5R-N.js";import{E as v}from"./eye-off-N0ImDqp6.js";import{E as P}from"./eye-D29FSyEF.js";import{C}from"./circle-alert-BSV6M1IC.js";import"./react-vendor-DDxydHEc.js";import"./house-CS3RhUwS.js";import"./query-vendor-Dpt6u7bR.js";import"./chart-vendor-8DIN3ZwM.js";function os(){const[,u]=z("/reset-password/:token"),[,S]=I(),k=q.auth.resetPassword.useMutation(),[h,p]=a.useState(!1),[n,L]=a.useState(!1),[c,E]=a.useState(!1),[f,A]=a.useState(!1),[e,w]=a.useState({password:"",confirmPassword:""}),[t,o]=a.useState({password:"",confirmPassword:""}),B=r=>r.length<8?"كلمة المرور يجب أن تكون 8 أحرف على الأقل":/[A-Z]/.test(r)?/[a-z]/.test(r)?/[0-9]/.test(r)?"":"يجب أن تحتوي على رقم واحد على الأقل":"يجب أن تحتوي على حرف صغير واحد على الأقل":"يجب أن تحتوي على حرف كبير واحد على الأقل",F=async r=>{r.preventDefault();const i=B(e.password);if(i){o({...t,password:i}),l.error(i);return}if(e.password!==e.confirmPassword){o({...t,confirmPassword:"كلمات المرور غير متطابقة"}),l.error("كلمات المرور غير متطابقة");return}if(!u?.token){l.error("رابط غير صالح");return}p(!0),o({password:"",confirmPassword:""});try{await k.mutateAsync({token:u.token,newPassword:e.password}),A(!0),l.success("تم تغيير كلمة المرور بنجاح!"),setTimeout(()=>{S("/login")},3e3)}catch(D){l.error(D?.message||"تعذر إعادة تعيين كلمة المرور")}finally{p(!1)}},g=(r=>r.length===0?{label:"",color:""}:r.length<8?{label:"ضعيفة",color:"text-red-500"}:r.length<12?{label:"متوسطة",color:"text-yellow-500"}:{label:"قوية",color:"text-green-500"})(e.password);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-primary/10 to-primary/5 flex items-center justify-center p-4",children:[s.jsx(R,{}),s.jsxs(M,{className:"w-full max-w-md",children:[s.jsxs(T,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:s.jsx(m,{className:"w-8 h-8 text-primary"})}),s.jsx(Z,{className:"text-2xl",children:"إعادة تعيين كلمة المرور"}),s.jsx($,{children:f?"تم تغيير كلمة المرور بنجاح":"أدخل كلمة مرور جديدة لحسابك"})]}),s.jsx(H,{children:f?s.jsxs("div",{className:"text-center space-y-6",children:[s.jsx("div",{className:"mx-auto w-20 h-20 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(x,{className:"w-12 h-12 text-green-600"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"font-semibold text-lg",children:"تم التغيير بنجاح!"}),s.jsx("p",{className:"text-muted-foreground",children:"تم تغيير كلمة المرور الخاصة بك بنجاح"})]}),s.jsx("div",{className:"bg-muted/50 p-4 rounded-lg text-sm text-muted-foreground",children:s.jsx("p",{children:"جاري تحويلك إلى صفحة تسجيل الدخول..."})}),s.jsx(j,{href:"/login",children:s.jsxs(d,{className:"w-full group",children:["تسجيل الدخول الآن",s.jsx(y,{className:"mr-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]}):s.jsxs("form",{onSubmit:F,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{htmlFor:"password",children:"كلمة المرور الجديدة"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(N,{id:"password",type:n?"text":"password",placeholder:"أدخل كلمة مرور قوية",className:"pr-10 pl-10",value:e.password,onChange:r=>{w({...e,password:r.target.value}),o({...t,password:""})},required:!0}),s.jsx("button",{type:"button",onClick:()=>L(!n),className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:n?s.jsx(v,{className:"h-5 w-5"}):s.jsx(P,{className:"h-5 w-5"})})]}),e.password&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-300 ${e.password.length<8?"w-1/3 bg-red-500":e.password.length<12?"w-2/3 bg-yellow-500":"w-full bg-green-500"}`})}),s.jsx("span",{className:`font-medium ${g.color}`,children:g.label})]}),t.password&&s.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[s.jsx(C,{className:"h-4 w-4"}),t.password]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{htmlFor:"confirmPassword",children:"تأكيد كلمة المرور"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(N,{id:"confirmPassword",type:c?"text":"password",placeholder:"أعد إدخال كلمة المرور",className:"pr-10 pl-10",value:e.confirmPassword,onChange:r=>{w({...e,confirmPassword:r.target.value}),o({...t,confirmPassword:""})},required:!0}),s.jsx("button",{type:"button",onClick:()=>E(!c),className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?s.jsx(v,{className:"h-5 w-5"}):s.jsx(P,{className:"h-5 w-5"})})]}),t.confirmPassword&&s.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[s.jsx(C,{className:"h-4 w-4"}),t.confirmPassword]})]}),s.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg text-sm space-y-2",children:[s.jsx("p",{className:"font-medium",children:"متطلبات كلمة المرور:"}),s.jsxs("ul",{className:"text-muted-foreground space-y-1 text-right",children:[s.jsx("li",{className:e.password.length>=8?"text-green-600":"",children:"• 8 أحرف على الأقل"}),s.jsx("li",{className:/[A-Z]/.test(e.password)?"text-green-600":"",children:"• حرف كبير واحد على الأقل"}),s.jsx("li",{className:/[a-z]/.test(e.password)?"text-green-600":"",children:"• حرف صغير واحد على الأقل"}),s.jsx("li",{className:/[0-9]/.test(e.password)?"text-green-600":"",children:"• رقم واحد على الأقل"})]})]}),s.jsx(d,{type:"submit",className:"w-full",size:"lg",disabled:h||!e.password||!e.confirmPassword,children:h?s.jsxs(s.Fragment,{children:[s.jsx(O,{className:"ml-2 h-4 w-4 animate-spin"}),"جاري التحديث..."]}):s.jsxs(s.Fragment,{children:["تحديث كلمة المرور",s.jsx(y,{className:"mr-2 h-4 w-4"})]})}),s.jsx("div",{className:"text-center",children:s.jsx(j,{href:"/login",children:s.jsx(d,{variant:"ghost",className:"text-sm",children:"العودة لتسجيل الدخول"})})})]})})]}),s.jsxs("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-4 text-xs text-muted-foreground bg-background/80 backdrop-blur-sm px-4 py-2 rounded-full border",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(x,{className:"h-3 w-3 text-green-600"}),s.jsx("span",{children:"تشفير 256-bit"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(x,{className:"h-3 w-3 text-green-600"}),s.jsx("span",{children:"آمن 100%"})]})]})]})}export{os as default};
